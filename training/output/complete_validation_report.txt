========================================================================================================================
完整特征验证报告
========================================================================================================================
生成时间: 2025-11-22 00:45:57
样本数量: 2591
特征数量: 23

========================================================================================================================
测试1: 单特征信息量测试
========================================================================================================================

排名     特征名                       组别              R²得分         互信息          综合得分        
------------------------------------------------------------------------------------------------------------------------
1      volume                    volume          0.000416     0.158117     0.158533    
2      EMA20                     technical       0.003946     0.132053     0.135999    
3      ATR14                     volatility      0.000036     0.120456     0.120492    
4      parkinson_vol             volatility      0.000006     0.116115     0.116121    
5      vol_20                    volatility      0.000186     0.109649     0.109835    
6      cos_tod                   time            0.000142     0.091306     0.091449    
7      dist_to_HH20              candlestick     0.000059     0.089163     0.089221    
8      price_slope_20            price_return    0.000148     0.085070     0.085218    
9      ret_5                     price_return    0.002254     0.080978     0.083232    
10     ret_20                    price_return    0.000010     0.069634     0.069644    
11     ret_1                     price_return    0.005486     0.059811     0.065297    
12     stoch                     technical       0.005756     0.058890     0.064647    
13     MACD                      technical       0.000632     0.063727     0.064359    
14     sin_tod                   time            0.000361     0.060611     0.060972    
15     pos_in_range_20           candlestick     0.000488     0.042219     0.042707    
16     volume_zscore             volume          0.000153     0.042407     0.042560    
17     C_div_MA20                price_return    0.000993     0.040287     0.041279    
18     lower_shadow_ratio        candlestick     0.000060     0.040625     0.040684    
19     OBV_slope_20              volume          0.000636     0.038175     0.038812    
20     dist_to_LL20              candlestick     0.000148     0.031329     0.031477    
21     volume_change_1           volume          0.000063     0.024687     0.024750    
22     FVG                       candlestick     0.000711     0.000495     0.001206    
23     upper_shadow_ratio        candlestick     0.000100     0.000000     0.000100    

========================================================================================================================
测试2: 特征相关性检测
========================================================================================================================

2.1 完整相关矩阵
------------------------------------------------------------------------------------------------------------------------

                       ret_1     ret_5    ret_20  price_slope_20  C_div_MA20     ATR14    vol_20  parkinson_vol     EMA20     stoch      MACD    volume  volume_zscore  volume_change_1  OBV_slope_20  pos_in_range_20  dist_to_HH20  dist_to_LL20  upper_shadow_ratio  lower_shadow_ratio       FVG   sin_tod   cos_tod
ret_1               1.000000  0.476618  0.218179        0.068410    0.387648 -0.009742 -0.015175      -0.052456 -0.024025  0.475614  0.071211 -0.105745      -0.094672        -0.066598      0.054432         0.353228      0.265581      0.277803            0.035663           -0.008676  0.486383  0.030884 -0.001996
ret_5               0.476618  1.000000  0.494526        0.352716    0.772424 -0.060314 -0.055287      -0.153292 -0.021308  0.700428  0.340891 -0.256924      -0.195552        -0.022078      0.280355         0.592589      0.540595      0.505221            0.033236            0.024226  0.505701  0.063552 -0.005879
ret_20              0.218179  0.494526  1.000000        0.923684    0.855328 -0.262470 -0.142181      -0.253796  0.089621  0.469963  0.892935 -0.328012      -0.106566        -0.007946      0.765557         0.736762      0.796670      0.622166           -0.001212            0.040408  0.232777  0.099225 -0.042361
price_slope_20      0.068410  0.352716  0.923684        1.000000    0.830675 -0.243373 -0.124815      -0.229712  0.081913  0.375786  0.879295 -0.297128      -0.090426         0.008268      0.817181         0.692087      0.755229      0.604756           -0.003224            0.042584  0.105843  0.094956 -0.047425
C_div_MA20          0.387648  0.772424  0.855328        0.830675    1.000000 -0.178661 -0.107332      -0.231729  0.031978  0.682591  0.738767 -0.337252      -0.177028        -0.013069      0.673406         0.794251      0.794385      0.687860            0.027241            0.042597  0.407275  0.098450 -0.032863
ATR14              -0.009742 -0.060314 -0.262470       -0.243373   -0.178661  1.000000  0.656084       0.748534 -0.610505 -0.109337 -0.382508  0.589864      -0.015715        -0.037520     -0.221870        -0.181634     -0.599899      0.355801            0.039171           -0.053999 -0.002320 -0.040177 -0.143933
vol_20             -0.015175 -0.055287 -0.142181       -0.124815   -0.107332  0.656084  1.000000       0.485397 -0.392954 -0.052551 -0.169684  0.524907       0.081965        -0.034303     -0.183313        -0.069657     -0.595875      0.554390            0.027685           -0.018423 -0.006937  0.148310 -0.308470
parkinson_vol      -0.052456 -0.153292 -0.253796       -0.229712   -0.231729  0.748534  0.485397       1.000000 -0.415903 -0.202566 -0.324632  0.809925       0.438901         0.145677     -0.199283        -0.253607     -0.515341      0.209903           -0.089974           -0.121266 -0.059549  0.019398 -0.339647
EMA20              -0.024025 -0.021308  0.089621        0.081913    0.031978 -0.610505 -0.392954      -0.415903  1.000000  0.029259  0.175562 -0.343024       0.055631        -0.005327      0.082542         0.054875      0.285952     -0.254596           -0.055801            0.030478 -0.035564  0.005519 -0.050626
stoch               0.475614  0.700428  0.469963        0.375786    0.682591 -0.109337 -0.052551      -0.202566  0.029259  1.000000  0.372950 -0.228428      -0.225550        -0.012129      0.322744         0.805103      0.548468      0.516608           -0.016693            0.054784  0.267555 -0.003906 -0.010377
MACD                0.071211  0.340891  0.892935        0.879295    0.738767 -0.382508 -0.169684      -0.324632  0.175562  0.372950  1.000000 -0.329094      -0.042005         0.002622      0.708701         0.661341      0.747926      0.496163           -0.011335            0.055120  0.122656  0.108838 -0.061439
volume             -0.105745 -0.256924 -0.328012       -0.297128   -0.337252  0.589864  0.524907       0.809925 -0.343024 -0.228428 -0.329094  1.000000       0.629376         0.243696     -0.287986        -0.285787     -0.579404      0.141167           -0.044346           -0.057079 -0.109143  0.149175 -0.466925
volume_zscore      -0.094672 -0.195552 -0.106566       -0.090426   -0.177028 -0.015715  0.081965       0.438901  0.055631 -0.225550 -0.042005  0.629376       1.000000         0.304830     -0.080139        -0.229356     -0.171976     -0.076112           -0.106543           -0.050470 -0.079500  0.249819 -0.218542
volume_change_1    -0.066598 -0.022078 -0.007946        0.008268   -0.013069 -0.037520 -0.034303       0.145677 -0.005327 -0.012129  0.002622  0.243696       0.304830         1.000000      0.005875        -0.023692     -0.005062     -0.015775           -0.031594           -0.005299 -0.031931  0.189753 -0.136840
OBV_slope_20        0.054432  0.280355  0.765557        0.817181    0.673406 -0.221870 -0.183313      -0.199283  0.082542  0.322744  0.708701 -0.287986      -0.080139         0.005875      1.000000         0.580568      0.682274      0.481033           -0.000717            0.021252  0.040491  0.042647 -0.040719
pos_in_range_20     0.353228  0.592589  0.736762        0.692087    0.794251 -0.181634 -0.069657      -0.253607  0.054875  0.805103  0.661341 -0.285787      -0.229356        -0.023692      0.580568         1.000000      0.707389      0.654914           -0.015829            0.059502  0.239436 -0.005679 -0.048644
dist_to_HH20        0.265581  0.540595  0.796670        0.755229    0.794385 -0.599899 -0.595875      -0.515341  0.285952  0.548468  0.747926 -0.579404      -0.171976        -0.005062      0.682274         0.707389      1.000000      0.250648           -0.018180            0.055948  0.232385 -0.009751  0.125138
dist_to_LL20        0.277803  0.505221  0.622166        0.604756    0.687860  0.355801  0.554390       0.209903 -0.254596  0.516608  0.496163  0.141167      -0.076112        -0.015775      0.481033         0.654914      0.250648      1.000000            0.019941            0.020335  0.242073  0.150729 -0.253120
upper_shadow_ratio  0.035663  0.033236 -0.001212       -0.003224    0.027241  0.039171  0.027685      -0.089974 -0.055801 -0.016693 -0.011335 -0.044346      -0.106543        -0.031594     -0.000717        -0.015829     -0.018180      0.019941            1.000000           -0.225928  0.084706  0.006793  0.018398
lower_shadow_ratio -0.008676  0.024226  0.040408        0.042584    0.042597 -0.053999 -0.018423      -0.121266  0.030478  0.054784  0.055120 -0.057079      -0.050470        -0.005299      0.021252         0.059502      0.055948      0.020335           -0.225928            1.000000 -0.010963 -0.020230 -0.009302
FVG                 0.486383  0.505701  0.232777        0.105843    0.407275 -0.002320 -0.006937      -0.059549 -0.035564  0.267555  0.122656 -0.109143      -0.079500        -0.031931      0.040491         0.239436      0.232385      0.242073            0.084706           -0.010963  1.000000  0.036821 -0.008558
sin_tod             0.030884  0.063552  0.099225        0.094956    0.098450 -0.040177  0.148310       0.019398  0.005519 -0.003906  0.108838  0.149175       0.249819         0.189753      0.042647        -0.005679     -0.009751      0.150729            0.006793           -0.020230  0.036821  1.000000 -0.237609
cos_tod            -0.001996 -0.005879 -0.042361       -0.047425   -0.032863 -0.143933 -0.308470      -0.339647 -0.050626 -0.010377 -0.061439 -0.466925      -0.218542        -0.136840     -0.040719        -0.048644      0.125138     -0.253120            0.018398           -0.009302 -0.008558 -0.237609  1.000000

2.2 高相关特征对 (|ρ| > 0.7)
------------------------------------------------------------------------------------------------------------------------
序号     特征1                       特征2                       相关系数           
------------------------------------------------------------------------------------------------------------------------
1      ret_20                    price_slope_20            0.923684       
2      ret_20                    MACD                      0.892935       
3      price_slope_20            MACD                      0.879295       
4      ret_20                    C_div_MA20                0.855328       
5      price_slope_20            C_div_MA20                0.830675       
6      price_slope_20            OBV_slope_20              0.817181       
7      parkinson_vol             volume                    0.809925       
8      stoch                     pos_in_range_20           0.805103       
9      ret_20                    dist_to_HH20              0.796670       
10     C_div_MA20                dist_to_HH20              0.794385       
11     C_div_MA20                pos_in_range_20           0.794251       
12     ret_5                     C_div_MA20                0.772424       
13     ret_20                    OBV_slope_20              0.765557       
14     price_slope_20            dist_to_HH20              0.755229       
15     ATR14                     parkinson_vol             0.748534       
16     MACD                      dist_to_HH20              0.747926       
17     C_div_MA20                MACD                      0.738767       
18     ret_20                    pos_in_range_20           0.736762       
19     MACD                      OBV_slope_20              0.708701       
20     pos_in_range_20           dist_to_HH20              0.707389       
21     ret_5                     stoch                     0.700428       

总计: 21对高相关特征

========================================================================================================================
测试3: VIF多重共线性检测
========================================================================================================================

排名     特征名                       VIF值            存在共线性          
------------------------------------------------------------------------------------------------------------------------
1      C_div_MA20                40.26           是              
2      price_slope_20            31.85           是              
3      dist_to_HH20              25.46           是              
4      dist_to_LL20              15.59           是              
5      ret_20                    14.27           是              
6      vol_20                    11.56           是              
7      ret_5                     8.83            否              
8      ATR14                     8.67            否              
9      volume                    8.21            否              
10     pos_in_range_20           7.63            否              
11     MACD                      7.05            否              
12     stoch                     5.82            否              
13     parkinson_vol             5.46            否              
14     volume_zscore             3.86            否              
15     OBV_slope_20              3.49            否              
16     sin_tod                   2.57            否              
17     ret_1                     1.93            否              
18     FVG                       1.88            否              
19     cos_tod                   1.85            否              
20     EMA20                     1.82            否              
21     volume_change_1           1.18            否              
22     upper_shadow_ratio        1.13            否              
23     lower_shadow_ratio        1.10            否              

存在多重共线性的特征数量: 6/23 (VIF > 10)

========================================================================================================================
测试4: 置换重要性测试
========================================================================================================================

注意: 置换重要性测试需要训练好的模型。
建议在模型训练完成后，使用以下代码进行测试：

```python
from src.features.feature_validator import FeatureValidator

validator = FeatureValidator()
perm_importance = validator.test_permutation_importance(
    model=trained_model,
    X_val=X_validation,
    y_val=y_validation,
    n_repeats=100
)
```

========================================================================================================================
核心特征推荐
========================================================================================================================

原始特征数量: 23
建议移除特征: 0
核心特征数量: 23
特征保留率: 100.0%

核心特征列表（按组别）:

price_return组 (5个):
  - ret_1 (得分: 0.065297)
  - ret_5 (得分: 0.083232)
  - ret_20 (得分: 0.069644)
  - price_slope_20 (得分: 0.085218)
  - C_div_MA20 (得分: 0.041279)

volatility组 (3个):
  - ATR14 (得分: 0.120492)
  - vol_20 (得分: 0.109835)
  - parkinson_vol (得分: 0.116121)

technical组 (3个):
  - EMA20 (得分: 0.135999)
  - stoch (得分: 0.064647)
  - MACD (得分: 0.064359)

volume组 (4个):
  - volume (得分: 0.158533)
  - volume_zscore (得分: 0.042560)
  - volume_change_1 (得分: 0.024750)
  - OBV_slope_20 (得分: 0.038812)

candlestick组 (6个):
  - pos_in_range_20 (得分: 0.042707)
  - dist_to_HH20 (得分: 0.089221)
  - dist_to_LL20 (得分: 0.031477)
  - upper_shadow_ratio (得分: 0.000100)
  - lower_shadow_ratio (得分: 0.040684)
  - FVG (得分: 0.001206)

time组 (2个):
  - sin_tod (得分: 0.060972)
  - cos_tod (得分: 0.091449)

========================================================================================================================
报告生成完成
========================================================================================================================