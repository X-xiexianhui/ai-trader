# 评估与验证配置文件

# Walk-Forward验证配置
walk_forward:
  train_window: 24  # 训练窗口（月）
  val_window: 6  # 验证窗口（月）
  test_window: 6  # 测试窗口（月）
  step_size: 6  # 滚动步长（月）
  min_train_size: 1000  # 最小训练集大小

# 特征重要性分析配置
feature_importance:
  n_repeats: 100  # 置换重复次数
  random_state: 42  # 随机种子
  top_n: 20  # 显示前N个特征
  significance_level: 0.05  # 显著性水平

# 消融实验配置
ablation:
  feature_groups:
    price_features:
      - ret_1
      - ret_5
      - ret_20
      - price_slope_20
      - C_div_MA20
    volatility_features:
      - ATR14_norm
      - vol_20
      - range_20_norm
      - BB_width_norm
      - parkinson_vol
    technical_features:
      - EMA20
      - stoch
      - MACD
      - VWAP
    volume_features:
      - volume
      - volume_zscore
      - volume_change_1
      - OBV_slope_20
    candlestick_features:
      - pos_in_range_20
      - dist_to_HH20_norm
      - dist_to_LL20_norm
      - body_ratio
      - upper_shadow_ratio
      - lower_shadow_ratio
      - FVG
    time_features:
      - sin_tod
      - cos_tod

# 过拟合检测配置
overfitting_detection:
  performance_gap_threshold: 0.10  # 性能差距阈值（10%）
  degradation_threshold: 0.05  # 退化阈值（5%）
  variance_increase_threshold: 0.50  # 方差增大阈值（50%）
  min_epochs: 10  # 最小epoch数

# 多Seed稳定性测试配置
stability_test:
  n_seeds: 10  # 测试种子数量
  base_seed: 42  # 基础随机种子
  cv_threshold: 0.10  # 变异系数阈值（10%）

# 市场状态识别配置
market_regime:
  trend_window: 20  # 趋势计算窗口
  volatility_window: 20  # 波动率计算窗口
  trend_threshold: 0.02  # 趋势阈值（2%）
  volatility_threshold: 0.03  # 高波动阈值（3%）

# 压力测试配置
stress_test:
  # 历史极端事件
  extreme_events:
    - name: "2008金融危机"
      start_date: "2008-09-01"
      end_date: "2009-03-31"
    - name: "2020新冠疫情"
      start_date: "2020-02-01"
      end_date: "2020-04-30"
    - name: "2022加息周期"
      start_date: "2022-03-01"
      end_date: "2022-12-31"
  
  # 压力测试场景
  scenarios:
    high_volatility:
      percentile: 0.90  # 高波动阈值（90分位）
    large_drops:
      percentile: 0.05  # 大幅下跌阈值（5分位）
    consecutive_drops:
      window: 5  # 连续下跌窗口
      threshold: 4  # 连续下跌次数

# 基准策略配置
benchmark:
  strategies:
    - name: "Buy & Hold"
      type: "buy_and_hold"
      params: {}
    
    - name: "MA Crossover"
      type: "ma_crossover"
      params:
        fast_window: 10
        slow_window: 30
    
    - name: "Momentum"
      type: "momentum"
      params:
        lookback: 20
  
  # 对比指标
  comparison_metrics:
    - total_return
    - cagr
    - sharpe_ratio
    - sortino_ratio
    - max_drawdown
    - win_rate
    - profit_factor

# 评估报告配置
report:
  output_dir: "results/evaluation"  # 输出目录
  formats:  # 生成格式
    - markdown
    - html
    - json
  include_plots: true  # 是否包含图表
  plot_dpi: 300  # 图表DPI
  
  # 报告章节
  sections:
    - walk_forward_validation
    - feature_importance
    - ablation_study
    - overfitting_detection
    - stability_test
    - market_regime_analysis
    - stress_test
    - benchmark_comparison

# 评估指标配置
metrics:
  # 收益指标
  return_metrics:
    - total_return
    - cagr
    - annualized_return
  
  # 风险指标
  risk_metrics:
    - volatility
    - max_drawdown
    - var_95
    - cvar_95
  
  # 风险调整收益
  risk_adjusted_metrics:
    - sharpe_ratio
    - sortino_ratio
    - calmar_ratio
    - information_ratio
  
  # 交易行为指标
  trading_metrics:
    - win_rate
    - profit_factor
    - avg_win
    - avg_loss
    - max_consecutive_wins
    - max_consecutive_losses

# 可视化配置
visualization:
  style: "seaborn"  # 绘图风格
  figsize: [12, 8]  # 图表大小
  dpi: 300  # 分辨率
  save_format: "png"  # 保存格式
  
  # 颜色配置
  colors:
    bull: "green"
    bear: "red"
    sideways: "gray"
    high_volatility: "orange"
    train: "blue"
    validation: "orange"
    test: "green"

# 日志配置
logging:
  level: "INFO"  # 日志级别
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "logs/evaluation.log"  # 日志文件